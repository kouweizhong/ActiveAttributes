<?xml version="1.0" encoding="utf-8" ?>

<!-- Copyright (c) rubicon IT GmbH, www.rubicon.eu
 !
 ! See the NOTICE file distributed with this work for additional information
 ! regarding copyright ownership.  rubicon licenses this file to you under 
 ! the Apache License, Version 2.0 (the "License"); you may not use this 
 ! file except in compliance with the License.  You may obtain a copy of the 
 ! License at
 !
 !   http://www.apache.org/licenses/LICENSE-2.0
 !
 ! Unless required by applicable law or agreed to in writing, software 
 ! distributed under the License is distributed on an "AS IS" BASIS, WITHOUT 
 ! WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  See the 
 ! License for the specific language governing permissions and limitations
 ! under the License.
-->

<!--
I. Overall

I.1 Each pattern can have <Match>....</Match> element. For the given type declaration, the pattern with the match, evaluated to 'true' with the largest weight, will be used 
I.2 Each pattern consists of the sequence of <Entry>...</Entry> elements. Type member declarations are distributed between entries
I.3 If pattern has RemoveAllRegions="true" attribute, then all regions will be cleared prior to reordering. Otherwise, only auto-generated regions will be cleared
I.4 The contents of each entry is sorted by given keys (First key is primary,  next key is secondary, etc). Then the declarations are grouped and en-regioned by given property

II. Available match operands

Each operand may have Weight="..." attribute. This weight will be added to the match weight if the operand is evaluated to 'true'.
The default weight is 1

II.1 Boolean functions:
II.1.1 <And>....</And>
II.1.2 <Or>....</Or>
II.1.3 <Not>....</Not>

II.2 Operands
II.2.1 <Kind Is="..."/>. Kinds are: class, struct, interface, enum, delegate, type, constructor, destructor, property, indexer, method, operator, field, constant, event, member
II.2.2 <Name Is="..." [IgnoreCase="true/false"] />. The 'Is' attribute contains regular expression
II.2.3 <HasAttribute CLRName="..." [Inherit="true/false"] />. The 'CLRName' attribute contains regular expression
II.2.4 <Access Is="..."/>. The 'Is' values are: public, protected, internal, protected internal, private
II.2.5 <Static/>
II.2.6 <Abstract/>
II.2.7 <Virtual/>
II.2.8 <Override/>
II.2.9 <Sealed/>
II.2.10 <Readonly/>
II.2.11 <ImplementsInterface CLRName="..."/>. The 'CLRName' attribute contains regular expression
II.2.12 <HandlesEvent />
-->

<Patterns xmlns="urn:shemas-jetbrains-com:member-reordering-patterns">

  <!--Do not reorder COM interfaces and structs marked by StructLayout attribute-->
  <Pattern>
    <Match>
      <Or Weight="100">
        <And>
          <Kind Is="interface"/>
          <Or>
            <HasAttribute CLRName="System.Runtime.InteropServices.InterfaceTypeAttribute"/>
            <HasAttribute CLRName="System.Runtime.InteropServices.ComImport"/>
          </Or>
        </And>
        <HasAttribute CLRName="System.Runtime.InteropServices.StructLayoutAttribute"/>
      </Or>
    </Match>
  </Pattern>

  <!--Default pattern-->
  <!--Do not update layout inside of regions-->
  <Pattern RemoveAllRegions="false">

    <!-- CONSTANTS -->
    <Entry>
      <Match>
        <Or>
          <Kind Is="constant"/>
          <And>
            <Static/>
            <Kind Is="field"/>
          </And>
        </Or>
      </Match>
      <Sort>
        <Access/>
        <Readonly/>
        <Name/>
      </Sort>
    </Entry>

    <!-- NESTED TYPES -->
    <Entry>
      <Match>
        <Kind Is="type"/>
      </Match>
      <Sort>
        <Name/>
      </Sort>
    </Entry>

    <!-- PUBLIC DELEGATES-->
    <Entry>
      <Match>
        <And>
          <Access Is="public"/>
          <Kind Is="delegate"/>
        </And>
      </Match>
      <Sort>
        <Name/>
      </Sort>
      <Group Region="Delegates"/>
    </Entry>

    <!-- PUBLIC ENUMS -->
    <Entry>
      <Match>
        <And>
          <Access Is="public"/>
          <Kind Is="enum"/>
        </And>
      </Match>
      <Sort>
        <Name/>
      </Sort>
    </Entry>

    <!-- STATIC MEMBERS -->
    <Entry>
      <Match>
        <And>
          <Static/>
          <Kind Is="event"/>
        </And>
      </Match>
      <Sort>
        <Access/>
      </Sort>
    </Entry>
    <Entry>
      <Match>
        <And>
          <Static/>
          <Or>
            <Kind Is="property"/>
            <Kind Is="indexer"/>
          </Or>
        </And>
      </Match>
      <Sort>
        <Access/>
      </Sort>
    </Entry>
    <Entry>
      <Match>
        <And>
          <Static/>
          <Kind Is="method"/>
        </And>
      </Match>
      <Sort>
        <Access/>
      </Sort>
    </Entry>

    <!-- MEMBER FIELDS -->
    <Entry>
      <Match>
        <And>
          <Kind Is="field"/>
          <Not>
            <Static/>
          </Not>
        </And>
      </Match>
      <Sort>
        <Access/>
        <Readonly/>
      </Sort>
    </Entry>

    <!-- CTOR AND DISPOSING -->
    <Entry>
      <Match>
        <Or>
          <Kind Is="constructor"/>
          <Kind Is="destructor"/>
          <ImplementsInterface CLRName="IDisposable"/>
        </Or>
      </Match>
      <Sort>
        <ImplementsInterface Immediate="true"/>
        <Static/>
        <Access/>
      </Sort>
    </Entry>
    
    <!-- PROPERTIES AND INDEXER -->
    <Entry>
      <Match>
        <Kind Is="event"/>
      </Match>
      <Sort>
        <Access/>
      </Sort>
    </Entry>

    <!-- PROPERTIES AND INDEXER -->
    <Entry>
      <Match>
        <Or>
          <Kind Is="property"/>
          <Kind Is="indexer"/>
        </Or>
      </Match>
      <Sort>
        <Access/>
      </Sort>
    </Entry>

    <!-- MEMBER METHODS -->
    <Entry>
      <Sort>
        <Access/>
      </Sort>
    </Entry>

  </Pattern>

</Patterns>
